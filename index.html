<!DOCTYPE html>
<html lang="tr">
<head>
	  <meta charset="UTF-8" />
	  <meta name="viewport" content="width=device-width, initial-scale=1" />
	  <!-- ðŸ”¹ Sosyal medya Ã¶n izleme meta etiketleri -->
	  <meta property="og:title" content="Zafer Mahallesi 4925/1 Parselleri" />
	  <meta property="og:description" content="SATILIK Ä°MARLI PARSELLER â€“ Zafer Mahallesi | Ä°mar: E=0.40 Hmax=2 Kat" />
	  <meta property="og:image" content="https://68meda68hub.github.io/zafer-mah-4925-1/images/1.jpeg" />
	  <meta property="og:url" content="https://68meda68hub.github.io/zafer-mah-4925-1/" />
	  <meta property="og:type" content="website" />
	  <meta property="og:locale" content="tr_TR" />

	  <meta name="twitter:card" content="summary_large_image" />
	  <meta name="twitter:title" content="Zafer Mahallesi 4925/1 Parselleri" />
	  <meta name="twitter:description" content="SATILIK Ä°MARLI PARSELLER â€“ Zafer Mahallesi | Ä°mar: E=0.40 Hmax=2 Kat" />
	  <meta name="twitter:image" content="https://68meda68hub.github.io/zafer-mah-4925-1/images/1.jpeg" />
  
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">


	<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
	  
	  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <style>
    body { 
	margin:0; 
	padding:0;
	}
#map { 
	position: absolute; 
    top: 0; 
    bottom: 0; 
    width: 100vw; 
    background: radial-gradient(
		circle at 50% 50%,
		rgba(85, 85, 170, 0.8) 0%,    /* merkez: hafif ÅŸeffaf parlak mavi-mor */
		rgba(68, 68, 170, 1) 15%,     /* merkeze yakÄ±n koyulaÅŸma */
		#222244 45%,                   /* orta alan: koyu mavi tonlarÄ± */
		#1a1a33 60%,                   /* kenar yakÄ±n: derin mavi-mor */
		#000000 100%                    /* uÃ§: tam siyah */
	);
    transition: background-color 5s ease; /* YumuÅŸak geÃ§iÅŸ */
	}

#loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba (0, 0, 0, 0.5);
    color: white; 
    font-size: 12px;
    padding: 5px 10px;
    border-radius: 5px;
    font-weight: bold;
    z-index: 9999;
    white-space: nowrap;
    opacity: 1;
    transition: all 2s ease;
    pointer-events: none;
    }

#loading.animate {
    top: calc(100% - 60px);
    transform: translate(-50%, 0);
    opacity: 0;
    }

#loading-bottom {
    position: fixed;
    bottom: 42px;
    left: 50%;
    transform: translateX(-50%);
    background: black;
    color: white;
    font-size: 11px;
    padding: 5px 5px;
    border-radius: 5px;
    font-weight: bold;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    z-index: 9999;
    transition: opacity 2s ease;
    }

#fade {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: white;
    opacity: 0;
    pointer-events: none;
    transition: opacity 2s;
    z-index: 998;
    }

.mapboxgl-popup {
    opacity: 0;
    transition: opacity 1.5s ease;
    }

.custom-popup {
    color: #fff;
    font-size: 12px;
    font-weight: 500;
    font-family: "Arial", sans-serif;
    padding: 5px 5px;
    background: rgba(0,0,0, 1);
    border-radius: 6px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.6);
    text-align: center;
    white-space: nowrap;
    line-height: 14px;
    }
.popup-subtext {
    font-size: 11px;
    color: #fff;
    font-style: italic;
    margin-top: 4px;
    display: block;
    }
	
#zoom-level {
	display: none;
    position: absolute;
    background: rgba (0, 0, 0, 0.5);
    padding: 5px 8px;
    margin: 10px;
    z-index: 1;
    border-radius: 4px;
    font-family: Tahoma;  
	font-size: 10px;
	color: #fff;	
	left: 0;
	bottom: 25px; 
	transition: color 0.3s ease; /* renk geÃ§iÅŸi yumuÅŸak olsun */
    }	
@media only screen and (max-width: 414px) {
#zoom-level {
    position: absolute;
    background: white;
    padding: 3px 3px;
    margin: 10px;
    z-index: 1;
    border-radius: 4px;
    font-family: Tahoma;  
	font-size: 9px;	
	left: 0;
	bottom: 40px; 
    }	
}


#current-time {
    position: absolute;
    right: 10px;
    bottom: 42px; /* zoom-levelâ€™le aynÄ± duracak */
    padding: 3px 6px;
    background: rgba(0,0,0,0.7);
    color: #fff;
    font-family: Tahoma;
    font-size: 10px;
    border-radius: 4px;
    z-index: 1;
    transition: color 0.3s ease, background 0.3s ease;
	}
/* sadece ikon bÃ¼yÃ¼sÃ¼n */
#current-time i {
	font-size: 14px; /* ikon biraz bÃ¼yÃ¼k */
	}
@media only screen and (max-width: 414px) {
	#current-time {
    right: 10px;
    bottom: 10px; /* zoom-levelâ€™le aynÄ± duracak */
    padding: 3px 6px;
    font-size: 10px;
    border-radius: 4px;
    z-index: 1;
    transition: color 0.3s ease, background 0.3s ease;
}}


.mapboxgl-popup-content {
  max-width: none !important;
  width: 310px !important;
  padding: 0;
  background: transparent;
  border-radius: 6px;
  box-shadow: none;
  overflow: visible;
}
.mapboxgl-popup-tip {
    border-top-color: #483c32 !important; /* popup zemin rengi ile aynÄ± */
}
.custom-popup-carousel {
    position: relative;
    left: -40px; /* popup gÃ¶vdesini sola kaydÄ±rÄ±r */
}


.custom-popup-carousel {
    width: 300px;
    text-align: center;
    background: #483c32; /* Ã§erÃ§eve rengi */
    border-radius: 6px;
    padding: 10px; /* ðŸ”¹ iÃ§ kenar boÅŸluÄŸu eklendi */
    position: relative;
    overflow: hidden;
    box-shadow: 0 6px 18px rgba(0,0,0,0.45);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    opacity: 1;
}

.custom-popup-carousel:hover {
    transform: scale(1.03);
    box-shadow: 0 10px 22px rgba(0,0,0,0.55);
}

.carousel-items {
    position: relative;
    width: 100%;
    height: 180px; /* ðŸ”¹ biraz kÃ¼Ã§Ã¼lttÃ¼k (200 â†’ 180) */
    border-radius: 8px;
    border-bottom: 2px solid #fff;
    background: #2f2720; /* kenar gÃ¶rÃ¼nÃ¼mÃ¼ iÃ§in arka plan tonu */
}

.carousel-item {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 0.8s ease-in-out;
}

.carousel-item.active {
    opacity: 1;
	}

.carousel-item img {
    width: 94%;         /* ðŸ”¹ %100 â†’ %94 */
    height: 94%;        /* ðŸ”¹ biraz kÃ¼Ã§Ã¼ltÃ¼ldÃ¼ */
    object-fit: cover;
    border-radius: 6px;
    margin-top: 3%;
    box-shadow: 0 0 6px rgba(0,0,0,0.4);
}

.carousel-item .caption {
    max-width: 90%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    color: #000;
    text-shadow: 0 0 2.5px #fff;
    padding: 3px 6px;
    font-size: 13px;
    background: none;
    border-radius: 3px;
    text-align: center;
    font-family: Tahoma, sans-serif;
    font-weight: 500;
}

.popup-subtext {
    font-family: 'Tahoma';
    font-size: 10px;
    color: #fffae0;
    font-weight: bold;
    line-height: 1.2; /* biraz daha rahat satÄ±r aralÄ±ÄŸÄ± */
    margin: 5px 0 0 0;
	}
.popup-subtext {
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizeLegibility;
	}

.carousel-dots {
    text-align: center;
    margin-top: 4px;
	}

.dot {
    display: inline-block;
    width: 4px;
    height: 4px;
    margin: 0 2px;
    background-color: rgba(100, 180, 255, 0.35);
    border-radius: 50%;
    transition: all 0.3s ease;
	}

.dot.active {
    background-color: #64b4ff;
    transform: scale(1.2);
}

/* VarsayÄ±lan masaÃ¼stÃ¼ boyutu */
.popup-close-btn {
	position: absolute;
	left: 5px;
	bottom: 5px;
	background: rgba(0,0,0,0.5);
	color: #fff;
	border: none;
	border-radius: 50%;
	width: 12px;
	height: 12px;
	font-size: 10px;
	line-height: 12px;
	text-align: center;
	cursor: pointer;
	box-shadow: 0 2px 5px rgba(0,0,0,0.3);
	transition: background 0.2s ease;
	padding: 0;
	}

.popup-close-btn:hover {
	background: #e04c4c;
}

/* Mobil uyumlu: ekran 480px veya daha kÃ¼Ã§Ã¼kse butonu kÃ¼Ã§Ã¼lt */
@media screen and (max-width: 414px) {
.popup-close-btn {
	width: 10px;
    height: 10px;
    font-size: 8px;
    line-height: 10px;
    left: 4px;
    bottom: 4px;
	}
}



  </style>
</head>
<body>

	<div id="loading"><sup><i>en </i></sup>NET<i> max</i> GAYRÄ°MENKUL</div>
	<div id="loading-bottom"><sup><i>en </i></sup>NET<i> max</i> GAYRÄ°MENKUL</div>
	<div id="fade"></div>

	<div id="map"></div>

	<div id="zoom-level">Zoom: --</div>
	<div id="current-time"><i class="fa-solid fa-clock"></i> --:--:--</div>


<script>
  mapboxgl.accessToken = 'pk.eyJ1IjoiZ2VvZ3JhcGh5cHJvZiIsImEiOiJjanYxb2t1ZG8wNGU1NGFsNXVkcnhzNmFpIn0.M3qCJK8FYa06B-Irc6FD-g';

  const initialCenter = [0, 0];
  const initialZoom = 0;

  const centerCoord = [34.007143, 38.412458];
  const pirlantaLabelGeoJSON = {
    type: "FeatureCollection",
    features: [
      {
        type: "Feature",
        geometry: {
          type: "Point",
          coordinates: [34.008482, 38.413084]
        },
        properties: {
          title: "PÄ±rlanta DÃ¼ÄŸÃ¼n Salonu"
        }
      }
    ]
  };
 

  const geojsonData = {
      "type": "FeatureCollection",
      "features": [
        { "type": "Feature", "properties": { "OBJECTID": 1, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/2", "DEGERI": null, "ACIKLAMA": "SATILDI", "ALAN_M2": 621.51 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.006707666868145, 38.412618875530811 ], [ 34.0064603372509, 38.412566737746801 ], [ 34.006442855020538, 38.41282092687851 ], [ 34.006495672299437, 38.412875562155385 ], [ 34.006629551840959, 38.412898698399296 ], [ 34.006707666868145, 38.412618875530811 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 2, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/3", "DEGERI": "200 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 621.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.006851211539939, 38.41293700390311 ], [ 34.006927105776491, 38.412665133372009 ], [ 34.006707666868145, 38.412618875530811 ], [ 34.006629551840959, 38.412898698399296 ], [ 34.006851211539939, 38.41293700390311 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 3, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/4", "DEGERI": "200 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 621.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007153159065524, 38.41271278503433 ], [ 34.007056728692156, 38.412692457731183 ], [ 34.006927105776491, 38.412665133372009 ], [ 34.006851211539939, 38.41293700390311 ], [ 34.007079552508067, 38.41297646352912 ], [ 34.007153159065524, 38.41271278503433 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 4, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/5", "DEGERI": "200 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 621.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007079552508067, 38.41297646352912 ], [ 34.00731521942766, 38.413017188639756 ], [ 34.007386464963382, 38.412761965009068 ], [ 34.007153159065524, 38.41271278503433 ], [ 34.007079552508067, 38.41297646352912 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 5, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/6", "DEGERI": "200 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 621.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.00731521942766, 38.413017188639756 ], [ 34.007473802449169, 38.413044592748435 ], [ 34.007553649400194, 38.413013342003907 ], [ 34.007666218919937, 38.41282093534975 ], [ 34.007386464963382, 38.412761965009068 ], [ 34.00731521942766, 38.413017188639756 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 6, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/7", "DEGERI": "180 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 846.08 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007739081565241, 38.412696396091349 ], [ 34.007101176104975, 38.412561928764426 ], [ 34.007056728692156, 38.412692457731183 ], [ 34.007153159065524, 38.41271278503433 ], [ 34.007386464963382, 38.412761965009068 ], [ 34.007666218919937, 38.41282093534975 ], [ 34.007739081565241, 38.412696396091349 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 7, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/8", "DEGERI": "180 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 884.53 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007145618273995, 38.412431414724146 ], [ 34.007101176104975, 38.412561928764426 ], [ 34.007739081565241, 38.412696396091349 ], [ 34.007811935622229, 38.412571871046765 ], [ 34.007145618273995, 38.412431414724146 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 8, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/9", "DEGERI": "180 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 923.07 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007145618273995, 38.412431414724146 ], [ 34.007811935622229, 38.412571871046765 ], [ 34.007884789432829, 38.412447345957702 ], [ 34.007190060287932, 38.412300900666359 ], [ 34.007145618273995, 38.412431414724146 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 9, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/10", "DEGERI": "180 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 961.61 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007190060287932, 38.412300900666359 ], [ 34.007884789432829, 38.412447345957702 ], [ 34.007957642997049, 38.412322820824173 ], [ 34.00771387269949, 38.412271435919124 ], [ 34.0074683111824, 38.412219672849446 ], [ 34.007234502146787, 38.412170386591029 ], [ 34.007190060287932, 38.412300900666359 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 10, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/11", "DEGERI": "200 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 621.49 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007957642997049, 38.412322820824173 ], [ 34.008039640708176, 38.412182665478142 ], [ 34.00796897714072, 38.412064202753967 ], [ 34.007796795271844, 38.412027908077718 ], [ 34.00771387269949, 38.412271435919124 ], [ 34.007957642997049, 38.412322820824173 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 11, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/12", "DEGERI": "200 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 621.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007551234527639, 38.411976145169184 ], [ 34.0074683111824, 38.412219672849446 ], [ 34.00771387269949, 38.412271435919124 ], [ 34.007796795271844, 38.412027908077718 ], [ 34.007551234527639, 38.411976145169184 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 12, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/13", "DEGERI": "200 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 621.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007234502146787, 38.412170386591029 ], [ 34.0074683111824, 38.412219672849446 ], [ 34.007551234527639, 38.411976145169184 ], [ 34.00730567242389, 38.411924381382569 ], [ 34.007222748305765, 38.412167908901679 ], [ 34.007234502146787, 38.412170386591029 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 13, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/14", "DEGERI": "200 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 621.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.006977186529141, 38.412116144594314 ], [ 34.007222748305765, 38.412167908901679 ], [ 34.00730567242389, 38.411924381382569 ], [ 34.007060111420152, 38.411872617236355 ], [ 34.006977186529141, 38.412116144594314 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 14, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/15", "DEGERI": null, "ACIKLAMA": "SATILDI", "ALAN_M2": 621.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.006814552175456, 38.411820852869447 ], [ 34.006731626511574, 38.412064380066255 ], [ 34.006977186529141, 38.412116144594314 ], [ 34.007060111420152, 38.411872617236355 ], [ 34.006814552175456, 38.411820852869447 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 15, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/16", "DEGERI": null, "ACIKLAMA": "SATILDI", "ALAN_M2": 621.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.006509608166368, 38.411850337565411 ], [ 34.006498270562574, 38.412015187631411 ], [ 34.006731626511574, 38.412064380066255 ], [ 34.006814552175456, 38.411820852869447 ], [ 34.006629600653682, 38.411781864338025 ], [ 34.006509608166368, 38.411850337565411 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 16, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/17", "DEGERI": "180 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 974.93 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.006977186529141, 38.412116144594314 ], [ 34.006731626511574, 38.412064380066255 ], [ 34.006498270562574, 38.412015187631411 ], [ 34.006488787551504, 38.412153071218519 ], [ 34.007190060287932, 38.412300900666359 ], [ 34.007234502146787, 38.412170386591029 ], [ 34.007222748305765, 38.412167908901679 ], [ 34.006977186529141, 38.412116144594314 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 17, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/18", "DEGERI": "180 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 927.5 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007190060287932, 38.412300900666359 ], [ 34.006488787551504, 38.412153071218519 ], [ 34.006479304510172, 38.412290954802131 ], [ 34.007145618273995, 38.412431414724146 ], [ 34.007190060287932, 38.412300900666359 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 18, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/19", "DEGERI": "180 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 880.08 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007145618273995, 38.412431414724146 ], [ 34.006479304510172, 38.412290954802131 ], [ 34.006469821438579, 38.41242883838229 ], [ 34.007101176104975, 38.412561928764426 ], [ 34.007145618273995, 38.412431414724146 ] ] ] ] } },
{ "type": "Feature", "properties": { "OBJECTID": 19, "ILCE": "Merkez", "MAHALLE": "Zafer", "PARSEL_NO": "4925/20", "DEGERI": "180 Euro/m2", "ACIKLAMA": null, "ALAN_M2": 832.76 }, "geometry": { "type": "MultiPolygon", "coordinates": [ [ [ [ 34.007101176104975, 38.412561928764426 ], [ 34.006469821438579, 38.41242883838229 ], [ 34.0064603372509, 38.412566737746801 ], [ 34.006707666868145, 38.412618875530811 ], [ 34.006927105776491, 38.412665133372009 ], [ 34.007056728692156, 38.412692457731183 ], [ 34.007101176104975, 38.412561928764426 ] ] ] ] } }
]
    };

  let markerAdded = false;
  let rotating = false;

  const map = new mapboxgl.Map({
    container: 'map',
		style: {
			version: 8,
			sources: {},
			layers: [],
			glyphs: 'https://api.mapbox.com/fonts/v1/mapbox/{fontstack}/{range}.pbf?access_token=' + mapboxgl.accessToken
    },
    center: [0, 0],
    zoom: 0.5,
	projection: 'globe'
  });
 
  
  const zoomLevelDiv = document.getElementById('zoom-level');

    function updateZoomLevel() {
        const zoom = map.getZoom().toFixed(2);
        zoomLevelDiv.textContent = `Zoom: ${zoom}`;
    }

    map.on('load', updateZoomLevel);
    map.on('zoom', updateZoomLevel);
    map.on('zoomend', updateZoomLevel);

  // â³ YÃ¼kleme ve uÃ§uÅŸ sÃ¼reci
  

  map.on('load', () => {
  
	// ðŸŒ KÃ¼re dÃ¶nÃ¼ÅŸ animasyonu
  let rotating = true;
  let rotateFrame;

  function rotateGlobe() {
    if (!rotating) return;
    const speed = 0.2;
    const center = map.getCenter();
    let newLng = center.lng + speed;
    if (newLng > 180) newLng -= 360;
    map.jumpTo({ center: [newLng, center.lat] });
    rotateFrame = requestAnimationFrame(rotateGlobe);
  }

  rotateGlobe();
 
// â³ YÃ¼kleme ve uÃ§uÅŸ sÃ¼reci
  setTimeout(() => {
    const loading = document.getElementById('loading');
    const loadingBottom = document.getElementById('loading-bottom');

    loading.classList.add('animate');

    setTimeout(() => {
      cancelAnimationFrame(rotateFrame);
      rotating = false;

      loading.style.display = 'none';
      loadingBottom.style.opacity = '1';

      map.once('idle', () => {
        map.flyTo({
          center: centerCoord,
          zoom: 17,
          speed: 0.3,
          curve: 1.5,
          essential: true
        });
      });

    }, 2000);
  }, 3000); 
  
  
    map.addSource('parcels', {
      type: 'geojson',
      data: geojsonData
    });
map.addSource('google-satellite', {
      type: 'raster',
      tiles: ['https://mt1.google.com/vt/lyrs=s,h,traffic&x={x}&y={y}&z={z}'],
      tileSize: 256
    });

    map.addLayer({
      id: 'google-satellite-layer',
      type: 'raster',
      source: 'google-satellite',
      layout: { visibility: 'visible' }
    });
    // Dolgu katmanÄ±
    map.addLayer({
      id: 'parcels-layer',
      type: 'fill',
      source: 'parcels',
      paint: {
        'fill-color': '#ffff00',
        'fill-opacity': 0.7
      },
      minzoom: 15
    });

    // Ã‡izgi katmanÄ±
    map.addLayer({
      id: 'parcels-outline',
      type: 'line',
      source: 'parcels',
      paint: {
        'line-color': '#0000ff',
        'line-width': 1,
		'line-opacity': 0.4
      },
      minzoom: 15
    });
	
	
	
	// 1ï¸âƒ£ Yeni kaynak ekliyoruz
map.addSource('manual-label', {
  type: 'geojson',
  data: {
    type: 'FeatureCollection',
    features: [
      {
        type: 'Feature',
        geometry: {
          type: 'Point',
          coordinates: [ 34.007165, 38.412408] // [lng, lat] ÅŸeklinde dikkat
        }
      }
    ]
  }
});

// 2ï¸âƒ£ Layer ekliyoruz
map.addLayer({
  id: 'manual-label-layer',
  type: 'symbol',
  source: 'manual-label',
  layout: {
    'text-field': 'Ä°mar Durumu\nE=0.40\nHmax=2 Kat', // Ä°ÅŸte buradaki \n ile iki satÄ±r yaptÄ±k
    'text-font': ['Open Sans Bold', 'Arial Unicode MS Bold'],
    'text-size': 12,
    'text-anchor': 'center',
    'text-allow-overlap': true
  },
  paint: {
    'text-color': '#FFD700', // sarÄ± yazÄ±
    'text-halo-color': '#000000', // siyah halo, okunabilirlik iÃ§in
    'text-halo-width': 1.5
  },
  minzoom: 17
});	

    // Zoom 0'dan 17'ye uÃ§uÅŸ yerine, yukarÄ±daki animasyon sonrasÄ± uÃ§uyoruz, bu yÃ¼zden burada yapmÄ±yoruz

    map.on('moveend', () => {
      const zoom = map.getZoom();

      if (zoom >= 17 && !markerAdded) {
        markerAdded = true;

		setTimeout(() => {
        new mapboxgl.Marker()
          .setLngLat(centerCoord)
          .addTo(map);
		}, 10000);
        // Slider popup
const popup = new mapboxgl.Popup({ offset: [0, -50], closeButton: false, closeOnClick: false })
      .setLngLat(centerCoord)
      .setHTML(`
        <div class="custom-popup-carousel">
          <div class="carousel-items">
            <div class="carousel-item active">
              <img src="images/Villa-Guzel-1.jpg">
              <p class="caption">Modern mimari villa yapmaya elveriÅŸli</p>
            </div>
            <div class="carousel-item">
              <img src="images/Villa-Guzel-5.jpg">
              <p class="caption">GeniÅŸ bahÃ§e imkanlÄ±</p>
            </div>
            <div class="carousel-item">
              <img src="images/Villa-Guzel-3.jpg">
              <p class="caption">GÃ¼neÅŸ Ä±ÅŸÄ±ÄŸÄ± alan Ã¶zel konumlanabilir</p>
            </div>
          </div>
          <div class="popup-subtext">SATILIK Ä°MARLI PARSELLER</div>	  
		  
			<button class="popup-close-btn">Ã—</button>
		  
          <div class="carousel-dots">
            <span class="dot active"></span>
            <span class="dot"></span>
            <span class="dot"></span>
          </div>
        </div>
      `)
      .addTo(map);
	  
	  // âœ… Popup DOM elementinin yÃ¼klenmesini garanti etmek iÃ§in setTimeout veya requestAnimationFrame kullan
requestAnimationFrame(() => {
  const closeBtn = popup.getElement().querySelector('.popup-close-btn');
  if (closeBtn) {
    closeBtn.addEventListener('click', () => {
      popup.remove();
    });
  }
});
	  	  
	 // Sliderâ€™Ä± baÅŸlat (popup DOM hazÄ±r olduktan sonra)
    setTimeout(() => {
        const popupEl = popup.getElement();
        if (!popupEl) return;

        const items = popupEl.querySelectorAll('.carousel-item');
        const dots = popupEl.querySelectorAll('.carousel-dots .dot');
        let current = 0;

        function showSlide(index) {
            items.forEach((item, i) => item.classList.toggle('active', i === index));
            dots.forEach((dot, i) => dot.classList.toggle('active', i === index));
        }

        showSlide(0);

        const interval = setInterval(() => {
            current = (current + 1) % items.length;
            showSlide(current);
        }, 5000);

        // Popup DOM silindiÄŸinde intervalâ€™i temizle
        popupEl.closest('.mapboxgl-popup').addEventListener('remove', () => {
            clearInterval(interval);
        });

    }, 200); // 200ms beklemek DOMâ€™un hazÄ±r olmasÄ± iÃ§in yeterli
	 
        setTimeout(() => {
          const popupEl = popup.getElement();
          if (popupEl) popupEl.style.opacity = '1';
        }, 10000);

        if (!map.getLayer('parcels-labels')) {
          map.addLayer({
            id: 'parcels-labels',
            type: 'symbol',
            source: 'parcels',
            layout: {
				'text-field': [
				'concat',
				['to-string', ['get', 'ALAN_M2']],' mÂ²'],
				'text-font': ['Open Sans Bold', 'Arial Unicode MS Bold'],
				'text-size': 10,
				'text-anchor': 'center',
				'text-allow-overlap': true
            },
            paint: {
              'text-color': '#000000',
			  'text-opacity': 0.6
            },
            minzoom: 15
          });
        }

        setTimeout(() => {
          if (map.getLayer('parcels-labels')) {
            map.removeLayer('parcels-labels', 'manual-label-layer');
          }
        }, 9000);

        setTimeout(() => {
          map.flyTo({
            zoom: 15,
            pitch: 45,
            speed: 0.1,
            curve: 1.8,
            essential: true
          });
        }, 10000);
      }

      if (Math.round(zoom) === 15 && !rotating) {
        rotating = true;

        let startBearing = map.getBearing();
        const duration = 30000;
        let startTime;

        function rotate(timestamp) {
          if (!startTime) startTime = timestamp;
          const elapsed = timestamp - startTime;
          const progress = Math.min(elapsed / duration, 1);
          const currentBearing = startBearing + progress * 360;

          map.setBearing(currentBearing);

          if (progress < 1) {
            requestAnimationFrame(rotate);
          }
        }

        setTimeout(() => requestAnimationFrame(rotate), 1000);
      }
    });
	
	
	map.addSource('pirlanta-label', {
      type: 'geojson',
      data: pirlantaLabelGeoJSON
    });

    map.addLayer({
      id: 'pirlanta-label-layer',
      type: 'symbol',
      source: 'pirlanta-label',
      layout: {
        'text-field': ['get', 'title'],
        'text-size': 12,
        'text-offset': [0, 0.6],
        'text-anchor': 'top',
        'text-font': ['Open Sans Bold', 'Arial Unicode MS Bold'],
        'text-allow-overlap': true
      },
      paint: {
        'text-color': '#ffffff',
        'text-halo-color': '#0000ff',
        'text-halo-width': 1
      },
      minzoom: 15 // istersen gÃ¶rÃ¼nmesi iÃ§in minimum zoom
    });

map.on('zoom', () => {
    const zoomLevel = map.getZoom();
    const zoomEl = document.getElementById('zoom-level');
    
    zoomEl.textContent = `Zoom: ${zoomLevel.toFixed(1)}`;

    if (zoomLevel >= 17) {
        zoomEl.style.color = '#000';
        zoomEl.style.background = 'rgba(255,255,255,1)'; // beyaz arka plan
    } else {
        zoomEl.style.color = '#fff';
        zoomEl.style.background = 'rgba(0,0,0,0.5)'; // siyah arka plan
    }
});

function updateTime() {
  const now = new Date();
  const timeString = now.toLocaleTimeString('tr-TR');
  document.getElementById('current-time').innerHTML = `<i class="fa-solid fa-clock"></i> ${timeString}`;
}

setInterval(updateTime, 1000);
updateTime();


// BaÅŸlangÄ±Ã§ta hemen gÃ¼ncelle
updateTime();
// Her saniye tekrar
setInterval(updateTime, 1000);




	
  });
</script>
</body>
</html>
